# 데이터베이스 설계와 ER모델(2)

### ER 모델의 또 다른 표기법

- 수십 개 이상의 애트리뷰트가 엔티티 타입에 연결된 다이어그램을 나타내려면 매우 불편하고 공간을 많이 차지함
- ERWin 등의 CASE 도구들에서는  **새발**(crow-feet)  표기법이 흔히 사용됨
- 새발 표기법에도 여러 가지 변형들이 존재함

![1](https://user-images.githubusercontent.com/77624879/163014314-4acfd7f6-d27b-4640-81f7-e9a8dda1c4fd.png)

### 새발 표기법으로 변환

![2](https://user-images.githubusercontent.com/77624879/163014319-82914cc4-839f-42fd-89da-aabc4fcfe74a.jpg)
![3](https://user-images.githubusercontent.com/77624879/163014320-a1cb7651-ec4e-4efe-b382-d54db4e76287.jpg)
![4](https://user-images.githubusercontent.com/77624879/163014322-df40f443-67ec-48c2-803e-4c6b3e629ba1.jpg)
![5](https://user-images.githubusercontent.com/77624879/163014323-b1f18387-e62e-4918-aa7a-22a8003726c9.jpg)

### 새발표기법 변환 요약

![6](https://user-images.githubusercontent.com/77624879/163014324-0d900ff8-b0d9-46df-ba3a-fa5295ee02c7.jpg)

### ER 스키마를 관계 모델의 릴레이션으로 사상

- 논리적 설계 단계에서는 ER 스키마를 관계 데이터 모델의 릴레이션들로 사상함
- ER 스키마에서는 엔티티 타입과 관계 타입이 존재하지만 관계 데이터베이스에는 엔티티 타입과 관계 타입을 구분하지 않고 릴레이션들만 있음
- 릴레이션으로 사상할 대상이 ER 스키마에서 엔티티 타입인지 또는 관계 타입인지
    - 엔티티 타입이라면 정규 엔티티 타입인지 또는 약한 엔티티 타입인지
    - 관계 타입이라면 2진 관계 타입인지, 3진 이상의 관계 타입인지
    - 애트리뷰트가 단일 값 애트리뷰트인지 또는 다치 애트리뷰트인지 등에 따라 사상하는 방법이 달라짐
- ER 모델을 릴레이션들로 사상하는 7개의 단계로 이루어진 알고리즘

![7](https://user-images.githubusercontent.com/77624879/163014326-1d7d1722-5bad-4964-b779-6432e1eca7df.jpg)

![8](https://user-images.githubusercontent.com/77624879/163014328-225edbd0-89d6-4ff8-9e7b-050c7e760420.png)

### ER-관계 사상 알고리즘

- **단계 1: 정규 엔티티 타입과 단일 값 애트리뷰트**
    - ER 스키마의 각 정규 엔티티 타입 E에 대해 하나의 릴레이션 R을 생성함
    - E에 있던 단순 애트리뷰트들을 릴레이션 R에 모두 포함시킴
    - E에서 복합 애트리뷰트는 그 복합 애트리뷰트를 구성하는 단순 애트리뷰트들만 릴레이션 R에 포함시킴
    - **E의 기본 키가 릴레이션 R의 기본 키가 됨**
    
    ![9](https://user-images.githubusercontent.com/77624879/163014330-dfe4a122-325c-4d35-89d1-0f4492f5a7fe.png)
    

- **단계 2: 약한 엔티티 타입과 단일 값 애트리뷰트**
    - ER 스키마에서 소유 엔티티 타입 E를 갖는 각 약한 엔티티 타입 W에 대하여 릴레이션 R을 생성함
    - W에 있던 모든 단순 애트리뷰트들을 릴레이션 R에 포함시킴
    - 소유 엔티티 타입에 해당하는 릴레이션의 기본 키를 약한 엔티티 타입에 해당하는 릴레이션에 외래 키로 포함시킴
    - 약한 엔티티 타입에 해당하는 **릴레이션 R의 기본 키**는 **약한 엔티티 타입의 부분 키**와 **소유 엔티티 타입에 해당하는 릴레이션을 참조하는 외래 키의 조합**으로 이루어짐
    
    ![10](https://user-images.githubusercontent.com/77624879/163014333-65a8a1b0-ba42-43a3-b595-80d8bb79e0c8.png)
    
- 단계 3: 2진 1:1 관계 타입
    - ER 스키마의 각 2진 1:1 관계 타입 R에 대하여, R에 참여하는 엔티티 타입에 대응되는 릴레이션 S와 T를 찾음
    - S와 T 중에서 한 릴레이션을 선택하여, **만일 S를 선택했다면 T의 기본 키를 S에 외래 키로 포함**시킴
    - S와 T 중에서 관계 타입에 완전하게 참여하는 릴레이션을 S의 역할을 하는 릴레이션으로 선택함
    - 관계 타입 R이 가지고 있는 모든 단순 애트리뷰트들을 S에 대응되는 릴레이션에 포함시킴
        - 복합 애트리뷰트를 갖고 있는 경우에는 복합 애트리뷰트를 구성하는 단순 애트리뷰트 들을 포함시킴
    - **두 엔티티 타입이 관계 타입 R에 완전하게 참여할 때는 두 엔티티 타입과 관계 타입을 하나의 릴레이션으로 합치는 방법도 가능함**
    
    ![11](https://user-images.githubusercontent.com/77624879/163014337-dddeca65-3493-4e50-932b-79d3fd325374.png)
    
    ![12](https://user-images.githubusercontent.com/77624879/163014341-ce6d5e62-6b66-479d-afd5-7e0e1a8d1115.png)
    
    - 주로 방법 1,2 사용

- 단계 4: 정규 2진 1:N 관계 타입
    - 정규 2진 1:N 관계 타입 R에 대하여 N측의 참여 엔티티 타입에 대응되는 릴레이션 S를 찾음
    - 관계 타입 R에 참여하는 **1측의 엔티티 타입에 대응되는 릴레이션 T의 기본 키를 릴레이션 S에 외래 키로 포함**시킴
    - N측의 릴레이션 S의 기본 키를 1측의 릴레이션 T에 외래키로 포함시키면 애트리뷰트에 값들의 집합이 들어가거나 정보의 중복이 많이 발생함
    - 관계 타입 R이 가지고 있는 모든 단순 애트리뷰트들을 S에 해당하는 릴레이션에 포함시킴
        - 복합 애트리뷰트를 갖고 있는 경우에는 복합 애트리뷰트를 구성하는 단순 애트리뷰트들을 포함시킴
    
   ![13](https://user-images.githubusercontent.com/77624879/163014344-54f8902b-bbf7-4973-889c-d1079f3329d3.png)
    
- 단계 5: 2진 M:N 관계 타입
    - 2진 M:N 관계 타입 R에 대해서는 릴레이션 R을 생성함
    - **참여 엔티티 타입에 해당하는 릴레이션들의 기본 키를 릴레이션 R의에 외래 키로 포함**시키고, **이들의 조합이 릴레이션 R의 기본 키**가 됨
    - 관계 타입 R이 가지고 있는 모든 단순 애트리뷰트들을 릴레이션 R에 포함시킴
        - 복합 애트리뷰트를 갖고 있는 경우에는 복합 애트리뷰트를 구성하는 단순 애트리뷰트를 포함시킴
    
    ![14](https://user-images.githubusercontent.com/77624879/163014346-6deb34ce-28dd-4199-a172-cf8e1b3a6a29.png)
    

- 단계 6: 3진 이상의 관계 타입
    - 3진 이상의 각 관계 타입 R에 대하여 릴레이션 R을 생성함
    - **관계 타입 R에 참여하는 모든 엔티티 타입에 대응되는 릴레이션들의 기본 키를 릴레이션 R에 외래 키로 포함**시킴
    - 관계 타입 R이 가지고 있는 모든 단순 애트리뷰트들을 릴레이션 R에 포함시킴
        - 복합 애트리뷰트를 갖고 있는 경우에는 복합 애트리뷰트를 구성하는 단순 애트리뷰트를 포함시킴
    - 일반적으로 **외래 키들의 조합이 릴레이션 R의 기본 키**가 됨
    - 관계 타입 **R에 참여하는 엔티티 타입들의 카디날리티가 1:N:N**이면 **카디날리티가 1인 릴레이션의 기본 키를 참조하는 외래 키를 제외**한 **나머지 외래 키들의 조합이 릴레이션 R의 기본 키**가 됨

![15](https://user-images.githubusercontent.com/77624879/163014349-965c13bf-c78b-46ac-9501-793b290dfb69.png)

- 단계 7: 다치 애트리뷰트
    - 각 다치 애트리뷰트에 대하여 릴레이션 R을 생성함
    - **다치 애트리뷰트에 해당하는 애트리뷰트를 릴레이션 R에 포함**시키고, **다치 애트리뷰트를 애트리뷰트로 갖는 엔티티 타입이나 관계 타입에 해당하는 릴레이션의 기본 키를 릴레이션 R에 외래 키로 포함**시킴
    - 릴레이션 **R의 기본 키**는 **다치 애트리뷰트와 외래 키의 조합**
    
    ![16](https://user-images.githubusercontent.com/77624879/163014353-fc5c3f80-f24f-4347-ac0a-677f3074c5ec.png)
    

### ER 개념과 데이터베이스 개념들의 대응 관계
![17](https://user-images.githubusercontent.com/77624879/163014356-c04a1021-dc3e-4640-b701-d0fac2e73306.png)
